<!DOCTYPE html>
<html lang="ko">
  <head>
    <title>Hello!</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="testyy.css">
    <link rel="icon" type="image/x-icon" href="images/favicon.ico">
  </head>  
  <body>
    <div class="container">
        <div draggable="true" class="box">A</div>
        <div draggable="true" class="box">B</div>
        <div draggable="true" class="box">C</div>
        <div draggable="true" class="box">D</div>
        <div draggable="true" class="box">E</div>
    </div>
    <script>
      const container = document.querySelector(".container");

      //dragstat, dragover, drop 순서로 구분

      let picked = null; // 당길 때의 대상을 변수에 설정
      container.addEventListener("dragstart", (e)=>{ // event라는 listner를 parameter로 받을 수 있음
        const obj = e.target;
        picked = obj

        //indexOf 사용하려면 배열로 변환해야함: html 컬렉션.. 
        pickedIndex = [...obj.parentNode.children].indexOf(obj) 
        //당기는 대상이 선택됨.. 인덱스를 파악해서 순서 바꿀 수 있음
      }) 
      container.addEventListener("dragover", (e)=>{
        e.preventDefault()
      })
      container.addEventListener("drop", (e)=>{
        //놓임을 당한 대상이 선택됨
        const obj = e.target;
        const index = [...obj.parentNode.children].indexOf(obj)

        //***순서 바꾸는 거*** not 서로 바꾸기
        //맨 마지막으로 옮길 때 밀리는 현상 해결해야 함
        index > pickedIndex ? obj.after(picked) : obj.before(picked)
      })
      
    </script>
  </body>
  
</html>